library(ggplot2)
data <- read.csv("../data/62DayDataModified.csv", header = TRUE)
data <- as.data.frame (data)
family1 = "poisson"
data$HB <- as.factor( data$HB )
data$CancerType <- as.factor( data$CancerType )
levels(data$HB) # 2 levels
levels(data$CancerType) # 2 levels
mod.1 <- glm( NumberOfEligibleReferrals62DayStandard ~ HB + CancerType + Date + DateSquared, data = data, family=family1 )
summary(mod.1)
coef(mod.1)
mod.1.predict <- predict( mod.1, type = "response" ) # to generate estimated number of deaths
AIC(mod.1)
BIC(mod.1)
library(ggplot2)
data <- read.csv("../data/62DayDataModified.csv", header = TRUE)
data <- as.data.frame (data)
family1 = "poisson"
data$HB <- as.factor( data$HB )
data$CancerType <- as.factor( data$CancerType )
levels(data$HB) # 2 levels
levels(data$CancerType) # 2 levels
mod.1 <- glm( NumberOfEligibleReferrals62DayStandard ~ HB + CancerType + Date + DateSquared, data = data, family=family1 )
summary(mod.1)
coef(mod.1)
mod.1.predict <- predict( mod.1, type = "response" ) # to generate estimated number of deaths
AIC(mod.1)
BIC(mod.1)
data$day <- seq(nrow(data))
plot <- ggplot( data, aes( day, fitted )) +
geom_line( aes(day, fitted), color = "red", size = 1.3 ) +
geom_point( aes(day, NumberOfEligibleReferrals62DayStandard), color = "blue", size = 2.3) +
scale_x_continuous( breaks= seq(1,16,2) )
plot +  labs( x="day", y="mortality rates", title ="Fitted and crude mortality rates")
mod.1.predict
View(data)
View(data)
data <- cbind( data, mod.1.predict )
names(data)[9] <- c("fitted")
library(ggplot2)
data <- read.csv("../data/62DayDataModified.csv", header = TRUE)
data <- as.data.frame (data)
family1 = "poisson"
data$HB <- as.factor( data$HB )
data$CancerType <- as.factor( data$CancerType )
levels(data$HB) # 2 levels
levels(data$CancerType) # 2 levels
mod.1 <- glm( NumberOfEligibleReferrals62DayStandard ~ HB + CancerType + Date + DateSquared, data = data, family=family1 )
summary(mod.1)
coef(mod.1)
mod.1.predict <- predict( mod.1, type = "response" ) # to generate estimated number of deaths
AIC(mod.1)
BIC(mod.1)
data <- cbind( data, mod.1.predict )
names(data)[9] <- c("fitted")
data$day <- seq(nrow(data))
plot <- ggplot( data, aes( day, fitted )) +
geom_line( aes(day, fitted), color = "red", size = 1.3 ) +
geom_point( aes(day, NumberOfEligibleReferrals62DayStandard), color = "blue", size = 2.3) +
scale_x_continuous( breaks= seq(1,16,2) )
plot +  labs( x="day", y="mortality rates", title ="Fitted and crude mortality rates")
subset(data, HB=S08000015)
subset?
subset ?
help
subset(data, HB==S08000015)
subset(data, HB==S08000015)
subset(data, data$HB==S08000015)
a<- subset(data, Hb==S08000015)
a
View(data)
subset(data, HB==S08000015, select=CancerType:fitted)
subset(data, HB=='S08000015')
data_plot <- subset(subset(data, HB=='S08000015'), CancerType='Breast')
data_plot$day <- seq(nrow(data_plot))
plot <- ggplot( data_plot, aes( day, fitted )) +
geom_line( aes(day, fitted), color = "red", size = 1.3 ) +
geom_point( aes(day, NumberOfEligibleReferrals62DayStandard), color = "blue", size = 2.3) +
scale_x_continuous( breaks= seq(1,16,2) )
plot +  labs( x="day", y="mortality rates", title ="Fitted and crude mortality rates")
data_plot
data_plot <- subset(subset(data, HB=='S08000015'), CancerType=='Breast')
data_plot$day <- seq(nrow(data_plot))
plot <- ggplot( data_plot, aes( day, fitted )) +
geom_line( aes(day, fitted), color = "red", size = 1.3 ) +
geom_point( aes(day, NumberOfEligibleReferrals62DayStandard), color = "blue", size = 2.3) +
scale_x_continuous( breaks= seq(1,16,2) )
plot +  labs( x="day", y="mortality rates", title ="Fitted and crude mortality rates")
plot <- ggplot( data_plot, aes( day, fitted )) +
geom_line( aes(day, fitted), color = "red", size = 1.3 ) +
geom_line( aes(day, NumberOfEligibleReferrals62DayStandard), color = "blue", size = 2.3) +
scale_x_continuous( breaks= seq(1,16,2) )
plot +  labs( x="day", y="mortality rates", title ="Fitted and crude mortality rates")
data_plot
data_plot <- subset(subset(data, HB=='S08000024'), CancerType=='Lung')
plot <- ggplot( data_plot, aes( day, fitted )) +
geom_line( aes(day, fitted), color = "red", size = 1.3 ) +
geom_line( aes(day, NumberOfEligibleReferrals62DayStandard), color = "blue", size = 2.3) +
scale_x_continuous( breaks= seq(1,16,2) )
plot +  labs( x="day", y="mortality rates", title ="Fitted and crude mortality rates")
data_plot
plot(Date, fitted)
plot(data_plot$Date, fitted)
plot(data_plot$Date, data_plot$fitted)
plot(data_plot$Date, data_plot$NumberOfEligibleReferrals62DayStandard)
plot <- plot(data_plot$Date, data_plot$fitted) + plot(data_plot$Date, data_plot$NumberOfEligibleReferrals62DayStandard)
plot +  labs( x="day", y="mortality rates", title ="Fitted and crude mortality rates")
plot
plot(data_plot$Date, data_plot$fitted) + plot(data_plot$Date, data_plot$NumberOfEligibleReferrals62DayStandard)
plot(data_plot$Quarter, data_plot$fitted,
main="Nr of Referrals in NHS Lothian for Lung Cancer",
ylab="time",
type="l",
col="blue")
plot(data_plot$Quarter, data_plot$fitted,
main="Nr of Referrals in NHS Lothian for Lung Cancer",
ylab="nr of referrals", xlab='time',
type="l",
col="blue")
plot(data_plot$Quarter, data_plot$fitted,
main="Nr of Referrals in NHS Lothian for Lung Cancer",
ylab="nr of referrals", xlab='time',
type="l",
col="blue")
lines(data_plot$Date, data_plot$NumberOfEligibleReferrals62DayStandard, col='red')
legend("topleft",
c("fitted","actual"),
fill=c("blue","red"))
plot(data_plot$Quarter, data_plot$fitted,
main="Nr of Referrals in NHS Lothian for Lung Cancer",
ylab="nr of referrals", xlab='time',
type="l",
col="blue")
lines(data_plot$Quarter, data_plot$NumberOfEligibleReferrals62DayStandard, col='red')
legend("topleft",
c("fitted","actual"),
fill=c("blue","red"))
data <- read.csv("../data/62DayDataModified.csv", header = TRUE)
data <- as.data.frame (data)
family1 = "poisson"
data$HB <- as.factor( data$HB )
data$CancerType <- as.factor( data$CancerType )
levels(data$HB) # 2 levels
levels(data$CancerType) # 2 levels
mod.1 <- glm( NumberOfEligibleReferrals62DayStandard ~ HB + CancerType + Date + DateSquared, data = data, family=family1 )
summary(mod.1)
coef(mod.1)
mod.1.predict <- predict( mod.1, type = "response" ) # to generate estimated number of deaths
AIC(mod.1)
BIC(mod.1)
data <- cbind( data, mod.1.predict )
names(data)[9] <- c("fitted")
data_plot <- subset(subset(data, HB=='S08000024'), CancerType=='Lung')
plot(data_plot$Quarter, data_plot$fitted,
main="Nr of Referrals in NHS Lothian for Lung Cancer",
ylab="nr of referrals", xlab='time',
type="l",
col="blue")
lines(data_plot$Quarter, data_plot$NumberOfEligibleReferrals62DayStandard, col='red')
legend("topleft",
c("fitted","actual"),
fill=c("blue","red"))
plot(data_plot$Date, data_plot$fitted,
main="Nr of Referrals in NHS Lothian for Lung Cancer",
ylab="nr of referrals", xlab='time',
type="l",
col="blue")
lines(data_plot$Date, data_plot$NumberOfEligibleReferrals62DayStandard, col='red')
legend("topleft",
c("fitted","actual"),
fill=c("blue","red"))
data_plot <- subset(subset(data, HB=='S08000024'), CancerType=='Breast')
plot(data_plot$Date, data_plot$fitted,
main="Nr of Referrals in NHS Lothian for Lung Cancer",
ylab="nr of referrals", xlab='time',
type="l",
col="blue")
lines(data_plot$Date, data_plot$NumberOfEligibleReferrals62DayStandard, col='red')
legend("topleft",
c("fitted","actual"),
fill=c("blue","red"))
plot(data_plot$Date, data_plot$NumberOfEligibleReferrals62DayStandard,
main="Nr of Referrals in NHS Lothian for Lung Cancer",
ylab="nr of referrals", xlab='time',
type="l",
col="blue")
lines(data_plot$Date, data_plot$fitted, col='red')
legend("topleft",
c("actual","fitted"),
fill=c("blue","red"))
data_plot <- subset(subset(data, HB=='S08000024'), CancerType=='Lung')
plot(data_plot$Date, data_plot$NumberOfEligibleReferrals62DayStandard,
main="Nr of Referrals in NHS Lothian for Lung Cancer",
ylab="nr of referrals", xlab='time',
type="l",
col="blue")
lines(data_plot$Date, data_plot$fitted, col='red')
data_plot <- subset(subset(data, HB=='S08000015'), CancerType=='Lung')
plot(data_plot$Date, data_plot$NumberOfEligibleReferrals62DayStandard,
main="Nr of Referrals in NHS Lothian for Lung Cancer",
ylab="nr of referrals", xlab='time',
type="l",
col="blue")
lines(data_plot$Date, data_plot$fitted, col='red')
legend("topleft",
c("actual","fitted"),
fill=c("blue","red"))
coeff <- coef(mod.1)
coeff
coeff[2:12]
coeff[2:14]
order(coeff[2:14])
region_coef <- coef(mod.1)[2:14]
cancer_coef <- coef(mod.1)[15:20]
region_coef[order(region_coef)]
coef(mod.1)[15:20]
coef(mod.1)[15:23]
region_coef <- coef(mod.1)[2:14]
region_coef <- region_coef[order(region_coef)]
cancer_coef <- coef(mod.1)[15:23]
cancer_coef <- cancer_coef[order(cancer_coef)]
region_coef$regions <- seq(nrow(region_coef))
y <- seq(nrow(region_coef))
y
region_coef
region_coef <- coef(mod.1)[2:14]
region_coef <- region_coef[order(region_coef)]
cancer_coef <- coef(mod.1)[15:23]
cancer_coef <- cancer_coef[order(cancer_coef)]
y <- seq(nrow(region_coef))
y
region_coef
lenght(region_coef)
length(region_coef)
y <- seq(length(region_coef))
y
plot(region_coef, y)
plot(region_coef, y,
main="Coefficients for regions",
ylab="regions")
plot(region_coef, y,
main="Coefficients for regions", col='green')
plot(region_coef, y,
main="Coefficients for regions",
type='p', col='green')
plot(region_coef, y,
main="Coefficients for regions",
pch='19', col='green')
plot(region_coef, y,
main="Coefficients for regions",
pch=19, col='green')
plot(region_coef, y,
main="Coefficients for regions",
pch=19, col='green', axis.labels=region_coef)
plot(region_coef, y,
main="Coefficients for regions",
pch=19, col='green', labels=region_coef)
plot(region_coef, y,
main="Coefficients for regions",
pch=19, col='green', labels.axis=region_coef)
plot(region_coef, y,
main="Coefficients for regions",
pch=19, col='green')
plot(region_coef, y,
main="Coefficients for regions",
pch=19, col='green')
plot(region_coef, y,
main="Coefficients for regions",
pch=19, col='green', labels.axis=cancer_coef)
region_coef.type
type(region_coef)
typeof(region_coef)
region_coef[0]
region_coef[1]
region_coef[1,1]
region_coef[1][1]
names(region_coef)
region_coef <- coef(mod.1)[2:14]
region_coef <- region_coef[order(region_coef)]
region_coef <- cbind( region_coef, 0 )
names(region_coef)[15] <- c("HBS08000015")
region_coef
region_coef <- coef(mod.1)[2:14]
region_coef <- region_coef[order(region_coef)]
region_coef <- rbind( region_coef, 0 )
region_coef
View(region_coef)
View(region_coef)
region_coef <- coef(mod.1)[2:14]
region_coef <- region_coef[order(region_coef)]
region_coef <- cbind( region_coef, [0] )
region_coef <- cbind( region_coef, 0 )
region_coef
region_coef <- cbind( region_coef, c(0) )
region_coef
region_coef <- rbind( region_coef, c(0) )
region_coef
region_coef <- coef(mod.1)[2:14]
region_coef <- as.data.frame( region_coef[order(region_coef)] )
region_coef <- rbind( region_coef, c(0) )
region_coef
names(region_coef)[15] <- c("HBS08000015")
region_coef <- rbind( region_coef, c("HBS08000015",0) )
region_coef
rownames(region_coef)[15] <- c("HBS08000015")
region_coef
region_coef <- coef(mod.1)[2:14]
region_coef <- as.data.frame( region_coef[order(region_coef)] )
region_coef <- rbind( region_coef, c("HBS08000015",0) )
rownames(region_coef)[15] <- c("HBS08000015")
region_coef
region_coef <- coef(mod.1)[2:14]
region_coef <- as.data.frame( region_coef[order(region_coef)] )
region_coef <- rbind( region_coef, c(0) )
rownames(region_coef)[15] <- c("HBS08000015")
region_coef <- coef(mod.1)[2:14]
region_coef <- as.data.frame( region_coef[order(region_coef)] )
region_coef <- rbind( region_coef, c(0) )
rownames(region_coef)[14] <- c("HBS08000015")
region_coef
region_coef <- as.data.frame( coef(mod.1)[2:14] )
region_coef <- rbind( region_coef, c(0) )
rownames(region_coef)[14] <- c("HBS08000015")
region_coef <- region_coef[order(region_coef)]
region_coef
c(region_coeff)
c(region_coef)
region_coef <- as.data.frame( coef(mod.1)[2:14], names='coef' )
region_coef
is.labelled(coef(mod.1))
typeof(coef(mod.1))
coef(mod.1)
coef(mod.1)[HBS08000019]
coef(mod.1)['HBS08000019']
region_coef['HBS08000015'] <- 0
region_coef
region_coef <- coef(mod.1)[2:14]
region_coef['HBS08000015'] <- 0
region_coef <- region_coef[order(region_coef)]
region_coef <- coef(mod.1)[2:14]
region_coef['HBS08000015'] <- 0
region_coef <- region_coef[order(region_coef)]
cancer_coef <- coef(mod.1)[15:23]
cancer_coef['CancerTypeBreast'] <- 0
cancer_coef <- cancer_coef[order(cancer_coef)]
y <- seq(length(region_coef))
plot(region_coef, y,
main="Coefficients for regions",
pch=19, col='green', labels.axis=region_coef)
plot(cancer_coef, y,
main="Coefficients for cancer types",
ylab="regions")
plot(cancer_coef, y,
main="Coefficients for cancer types",
pch=19, col='green', labels.axis=region_coef)
y_reg <- seq(length(region_coef))
y_can <- seq(length(cancer_coef))
plot(region_coef, y_reg,
main="Coefficients for regions",
pch=19, col='green', labels.axis=region_coef)
plot(cancer_coef, y_can,
main="Coefficients for cancer types",
pch=19, col='green', labels.axis=region_coef)
plot(region_coef, y_reg,
main="Coefficients for regions",
pch=19, col='green', labels.axis=region_coef,
xlab='n', ylab='n')
plot(region_coef, y_reg,
main="Coefficients for regions",
pch=19, col='green', labels.axis=region_coef,
xlab='na', ylab='na')
names(region_coef)
plot(region_coef, y_reg,
main="Coefficients for regions",
pch=19, col='green', labels.axis=region_coef, axes=False)
axis(2, at=y_reg, labels=names(region_coef))
axis(2, at=y_reg, labels=names(region_coef), las=2)
plot(region_coef, y_reg,
main="Coefficients for regions",
pch=19, col='green', labels.axis=region_coef, yaxt='n')
axis(2, at=y_reg, labels=names(region_coef), las=2)
plot(region_coef, y_reg,
main="Coefficients for regions",
pch=19, col='green', labels.axis=region_coef, yaxt='n'
xlab='', ylab='')
axis(2, at=y_reg, labels=names(region_coef), las=2)
plot(region_coef, y_reg,
main="Coefficients for regions",
pch=19, col='green', labels.axis=region_coef, yaxt='n'
xlab='', ylab='')
axis(2, at=y_reg, labels=names(region_coef), las=2)
plot(region_coef, y_reg,
main="Coefficients for regions",
pch=19, col='green', labels.axis=region_coef, yaxt='n',
xlab='', ylab='')
axis(2, at=y_reg, labels=names(region_coef), las=2)
plot(region_coef, y_reg,
main="Coefficients for regions",
pch=19, col='green', yaxt='n',
xlab='', ylab='')
axis(2, at=y_reg, labels=names(region_coef), las=2)
plot(cancer_coef, y_can,
main="Coefficients for cancer types",
pch=19, col='green', yaxt='n',
xlab='', ylab='')
axis(2, at=y_reg, labels=names(cancer_coef), las=2)
axis(2, at=y_can, labels=names(cancer_coef), las=2)
par(mar=c(5.1,7,4.1,2.1))
pmlot(cancer_coef, y_can,
main="Coefficients for cancer types",
pch=19, col='green', yaxt='n',
xlab='', ylab='')
plot(cancer_coef, y_can,
main="Coefficients for cancer types",
pch=19, col='green', yaxt='n',
xlab='', ylab='')
axis(2, at=y_can, labels=names(cancer_coef), las=2)
par(mar=c(5.1,7,4.1,2.1))
par(mar=c(6.1,7,4.1,2.1))
plot(region_coef, y_reg,
main="Coefficients for regions",
pch=19, col='green', yaxt='n',
xlab='', ylab='')
axis(2, at=y_reg, labels=names(region_coef), las=2)
plot(cancer_coef, y_can,
main="Coefficients for cancer types",
pch=19, col='green', yaxt='n',
xlab='', ylab='')
axis(2, at=y_can, labels=names(cancer_coef), las=2)
data <- read.csv("../data/62DayDataModified.csv", header = TRUE)
data <- as.data.frame (data)
family1 = "poisson"
data$HB <- as.factor( data$HB )
data$CancerType <- as.factor( data$CancerType )
levels(data$HB) # 2 levels
levels(data$CancerType) # 2 levels
mod.1 <- glm( NumberOfEligibleReferrals62DayStandard ~ HB + CancerType + Date + DateSquared, data = data, family=family1 )
summary(mod.1)
coef(mod.1)
mod.1.predict <- predict( mod.1, type = "response" ) # to generate estimated number of deaths
AIC(mod.1)
BIC(mod.1)
data <- cbind( data, mod.1.predict )
names(data)[9] <- c("fitted")
data_plot <- subset(subset(data, HB=='S08000015'), CancerType=='Lung')
plot(data_plot$Date, data_plot$NumberOfEligibleReferrals62DayStandard,
main="Nr of Referrals in NHS Lothian for Lung Cancer",
ylab="nr of referrals", xlab='time',
type="l",
col="blue")
lines(data_plot$Date, data_plot$fitted, col='red')
plot(data_plot$Date, data_plot$NumberOfEligibleReferrals62DayStandard,
main="Nr of Referrals in NHS Lothian for Lung Cancer",
ylab="nr of referrals", xlab='time',
type="l",
col="blue", xaxt='n')
axis(0, at=data_plot$Date, labels=names(data_plot$Quarter))
axis(1, at=data_plot$Date, labels=names(data_plot$Quarter))
axis(1, at=data_plot$Date, labels=data_plot$Quarter)
plot(data_plot$Date, data_plot$NumberOfEligibleReferrals62DayStandard,
main="Nr of Referrals in NHS Lothian for Lung Cancer",
ylab="nr of referrals", xlab='time',
type="l",
col="blue", xaxt='n')
axis(1, at=data_plot$Date, labels=data_plot$Quarter)
lines(data_plot$Date, data_plot$fitted, col='red')
plot(data_plot$Date, data_plot$NumberOfEligibleReferrals62DayStandard,
main="Nr of Referrals in NHS Lothian for Lung Cancer",
ylab="nr of referrals", xlab='time',
type="l",
col="blue", xaxt='n')
axis(1, at=data_plot$Date, labels=data_plot$Quarter, las=2)
plot(data_plot$Date, data_plot$NumberOfEligibleReferrals62DayStandard,
main="Nr of Referrals in NHS Lothian for Lung Cancer",
ylab="nr of referrals", xlab='time',
type="l",
col="blue", xaxt='n')
axis(1, at=data_plot$Date, labels=data_plot$Quarter, las=1.5)
plot(data_plot$Date, data_plot$NumberOfEligibleReferrals62DayStandard,
main="Nr of Referrals in NHS Lothian for Lung Cancer",
ylab="nr of referrals", xlab='time',
type="l",
col="blue", xaxt='n')
axis(1, at=data_plot$Date, labels=data_plot$Quarter)
lines(data_plot$Date, data_plot$fitted, col='red')
legend("topleft",
c("actual","fitted"),
fill=c("blue","red"))
region_coef <- coef(mod.1)[2:14]
region_coef['HBS08000015'] <- 0
region_coef <- region_coef[order(region_coef)]
cancer_coef <- coef(mod.1)[15:23]
cancer_coef['CancerTypeBreast'] <- 0
cancer_coef <- cancer_coef[order(cancer_coef)]
y_reg <- seq(length(region_coef))
y_can <- seq(length(cancer_coef))
par(mar=c(6.1,7,4.1,2.1))
plot(region_coef, y_reg,
main="Coefficients for regions",
pch=19, col='green', yaxt='n',
xlab='', ylab='')
axis(2, at=y_reg, labels=names(region_coef), las=2)
plot(cancer_coef, y_can,
main="Coefficients for cancer types",
pch=19, col='green', yaxt='n',
xlab='', ylab='')
axis(2, at=y_can, labels=names(cancer_coef), las=2)
